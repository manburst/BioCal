<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Omics Tools</title>
  <!-- Link to your shared CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Header -->
  <header class="header">
    <h1>Omics Tools</h1>
    <nav class="navbar">
      <ul>
        <li><a href="index.html">Home</a></li>
      </ul>
    </nav>
  </header>

  <main>

    <!-- ===================== DNA SECTION (unchanged) ====================== -->
    <section id="dna-section" class="calc-section active">
      <h2>DNA Tools</h2>
      <p>
        Input a DNA sequence (using A, T, G, C). We’ll calculate:
        <ul>
          <li><strong>Length</strong> of the sequence</li>
          <li><strong>GC content</strong></li>
          <li><strong>Reverse complement</strong></li>
          <li><strong>Transcription</strong> (DNA → RNA)</li>
          <li><strong>Translation</strong> (DNA → protein)</li>
          <li><strong>Base counts</strong> (our extra idea)</li>
        </ul>
      </p>
      <form class="calc-form">
        <div class="form-group">
          <label for="dnaInput">DNA Sequence</label>
          <textarea id="dnaInput" placeholder="e.g., ATGCGT..." rows="3"></textarea>
        </div>
        <!-- Buttons: Calculate + Clear -->
        <button type="button" id="dnaCalcBtn" class="primary-btn">Calculate DNA Info</button>
        <button type="button" id="dnaClearBtn" class="primary-btn" style="background-color:#999;">
          Clear
        </button>
      </form>
      <div id="dnaResult" class="result-box"></div>
    </section>


    <!-- ===================== RNA SECTION (unchanged) ====================== -->
    <section id="rna-section" class="calc-section active">
      <h2>RNA Tools</h2>
      <p>
        Input an RNA sequence (using A, U, G, C). We’ll compute:
        <ul>
          <li><strong>Length</strong> of the sequence</li>
          <li><strong>GC content</strong></li>
          <li><strong>Reverse complement</strong> (RNA-based)</li>
          <li><strong>Reverse transcription</strong> (RNA → DNA)</li>
          <li><strong>Translation</strong> (RNA → protein)</li>
          <li><strong>Check for start codon</strong> (AUG), etc.</li>
        </ul>
      </p>
      <form class="calc-form">
        <div class="form-group">
          <label for="rnaInput">RNA Sequence</label>
          <textarea id="rnaInput" placeholder="e.g., AUGCGU..." rows="3"></textarea>
        </div>
        <!-- Buttons: Calculate + Clear -->
        <button type="button" id="rnaCalcBtn" class="primary-btn">Calculate RNA Info</button>
        <button type="button" id="rnaClearBtn" class="primary-btn" style="background-color:#999;">
          Clear
        </button>
      </form>
      <div id="rnaResult" class="result-box"></div>
    </section>


    <!-- ===================== PROTEIN SECTION (Updated) ====================== -->
    <section id="protein-section" class="calc-section active">
      <h2>Protein Tools</h2>
      <p>
        Enter a protein sequence in <strong>one-letter</strong> or 
        <strong>three-letter</strong> format (e.g., <em>Ala-Gly-Phe</em>).
        We'll parse it accordingly, compute:
        <ul>
          <li><strong>Length</strong> (# of amino acids)</li>
          <li><strong>Composition</strong> (# of each AA)</li>
          <li><strong>Reverse translation</strong> (protein → naive RNA codons)</li>
          <li>And output both <strong>one-letter</strong> and <strong>three-letter</strong> codes</li>
        </ul>
      </p>
      <form class="calc-form">

        <!-- Select: user declares input format explicitly -->
        <div class="form-group">
          <label for="protInputFormat">Protein Input Format:</label>
          <select id="protInputFormat">
            <option value="one">One-Letter Code</option>
            <option value="three">Three-Letter Code</option>
          </select>
        </div>

        <div class="form-group">
          <label for="protInput">Protein Sequence</label>
          <textarea id="protInput" placeholder="e.g., AGPN or Ala-Gly-Pro-Asn" rows="3"></textarea>
        </div>

        <!-- Buttons: Calculate + Clear -->
        <button type="button" id="protCalcBtn" class="primary-btn">Calculate Protein Info</button>
        <button type="button" id="protClearBtn" class="primary-btn" style="background-color:#999;">
          Clear
        </button>
      </form>
      <div id="protResult" class="result-box"></div>
    </section>

  </main>

  <!-- Embedded JS (including updated Protein logic) -->
  <script>
    /****************************************************
     *  CODON & PROTEIN TABLES (unchanged)
     ****************************************************/
    const CODON_TABLE = {
      "UUU": { "one_letter": "F", "three_letter": "Phe" },
      "UUC": { "one_letter": "F", "three_letter": "Phe" },
      "UUA": { "one_letter": "L", "three_letter": "Leu" },
      "UUG": { "one_letter": "L", "three_letter": "Leu" },
      "UCU": { "one_letter": "S", "three_letter": "Ser" },
      "UCC": { "one_letter": "S", "three_letter": "Ser" },
      "UCA": { "one_letter": "S", "three_letter": "Ser" },
      "UCG": { "one_letter": "S", "three_letter": "Ser" },
      "UAU": { "one_letter": "Y", "three_letter": "Tyr" },
      "UAC": { "one_letter": "Y", "three_letter": "Tyr" },
      "UAA": { "one_letter": "*", "three_letter": "Stop" },
      "UAG": { "one_letter": "*", "three_letter": "Stop" },
      "UGU": { "one_letter": "C", "three_letter": "Cys" },
      "UGC": { "one_letter": "C", "three_letter": "Cys" },
      "UGA": { "one_letter": "*", "three_letter": "Stop" },
      "UGG": { "one_letter": "W", "three_letter": "Trp" },
      "CUU": { "one_letter": "L", "three_letter": "Leu" },
      "CUC": { "one_letter": "L", "three_letter": "Leu" },
      "CUA": { "one_letter": "L", "three_letter": "Leu" },
      "CUG": { "one_letter": "L", "three_letter": "Leu" },
      "CCU": { "one_letter": "P", "three_letter": "Pro" },
      "CCC": { "one_letter": "P", "three_letter": "Pro" },
      "CCA": { "one_letter": "P", "three_letter": "Pro" },
      "CCG": { "one_letter": "P", "three_letter": "Pro" },
      "CAU": { "one_letter": "H", "three_letter": "His" },
      "CAC": { "one_letter": "H", "three_letter": "His" },
      "CAA": { "one_letter": "Q", "three_letter": "Gln" },
      "CAG": { "one_letter": "Q", "three_letter": "Gln" },
      "CGU": { "one_letter": "R", "three_letter": "Arg" },
      "CGC": { "one_letter": "R", "three_letter": "Arg" },
      "CGA": { "one_letter": "R", "three_letter": "Arg" },
      "CGG": { "one_letter": "R", "three_letter": "Arg" },
      "AUU": { "one_letter": "I", "three_letter": "Ile" },
      "AUC": { "one_letter": "I", "three_letter": "Ile" },
      "AUA": { "one_letter": "I", "three_letter": "Ile" },
      "AUG": { "one_letter": "M", "three_letter": "Met" },
      "ACU": { "one_letter": "T", "three_letter": "Thr" },
      "ACC": { "one_letter": "T", "three_letter": "Thr" },
      "ACA": { "one_letter": "T", "three_letter": "Thr" },
      "ACG": { "one_letter": "T", "three_letter": "Thr" },
      "AAU": { "one_letter": "N", "three_letter": "Asn" },
      "AAC": { "one_letter": "N", "three_letter": "Asn" },
      "AAA": { "one_letter": "K", "three_letter": "Lys" },
      "AAG": { "one_letter": "K", "three_letter": "Lys" },
      "AGU": { "one_letter": "S", "three_letter": "Ser" },
      "AGC": { "one_letter": "S", "three_letter": "Ser" },
      "AGA": { "one_letter": "R", "three_letter": "Arg" },
      "AGG": { "one_letter": "R", "three_letter": "Arg" },
      "GUU": { "one_letter": "V", "three_letter": "Val" },
      "GUC": { "one_letter": "V", "three_letter": "Val" },
      "GUA": { "one_letter": "V", "three_letter": "Val" },
      "GUG": { "one_letter": "V", "three_letter": "Val" },
      "GCU": { "one_letter": "A", "three_letter": "Ala" },
      "GCC": { "one_letter": "A", "three_letter": "Ala" },
      "GCA": { "one_letter": "A", "three_letter": "Ala" },
      "GCG": { "one_letter": "A", "three_letter": "Ala" },
      "GAU": { "one_letter": "D", "three_letter": "Asp" },
      "GAC": { "one_letter": "D", "three_letter": "Asp" },
      "GAA": { "one_letter": "E", "three_letter": "Glu" },
      "GAG": { "one_letter": "E", "three_letter": "Glu" },
      "GGU": { "one_letter": "G", "three_letter": "Gly" },
      "GGC": { "one_letter": "G", "three_letter": "Gly" },
      "GGA": { "one_letter": "G", "three_letter": "Gly" },
      "GGG": { "one_letter": "G", "three_letter": "Gly" }
    };

    const PROTEIN_TABLE = {
      "A": { "three_letter": "Ala", "full_name": "Alanine" },
      "R": { "three_letter": "Arg", "full_name": "Arginine" },
      "N": { "three_letter": "Asn", "full_name": "Asparagine" },
      "D": { "three_letter": "Asp", "full_name": "Aspartic acid" },
      "C": { "three_letter": "Cys", "full_name": "Cysteine" },
      "E": { "three_letter": "Glu", "full_name": "Glutamic acid" },
      "Q": { "three_letter": "Gln", "full_name": "Glutamine" },
      "G": { "three_letter": "Gly", "full_name": "Glycine" },
      "H": { "three_letter": "His", "full_name": "Histidine" },
      "I": { "three_letter": "Ile", "full_name": "Isoleucine" },
      "L": { "three_letter": "Leu", "full_name": "Leucine" },
      "K": { "three_letter": "Lys", "full_name": "Lysine" },
      "M": { "three_letter": "Met", "full_name": "Methionine" },
      "F": { "three_letter": "Phe", "full_name": "Phenylalanine" },
      "P": { "three_letter": "Pro", "full_name": "Proline" },
      "S": { "three_letter": "Ser", "full_name": "Serine" },
      "T": { "three_letter": "Thr", "full_name": "Threonine" },
      "W": { "three_letter": "Trp", "full_name": "Tryptophan" },
      "Y": { "three_letter": "Tyr", "full_name": "Tyrosine" },
      "V": { "three_letter": "Val", "full_name": "Valine" }
    };

    /*********************************************
     * DNA & RNA Tools (unchanged code)
     *********************************************/
    /* Same as your existing logic for dnaCalcBtn, rnaCalcBtn, etc. */


    /*********************************************
     * PROTEIN TOOLS (Updated)
     *********************************************/
    const protInputFormat = document.getElementById('protInputFormat'); // new select
    const protCalcBtn   = document.getElementById('protCalcBtn');
    const protClearBtn  = document.getElementById('protClearBtn');
    const protInput     = document.getElementById('protInput');
    const protResult    = document.getElementById('protResult');

    protCalcBtn.addEventListener('click', () => {
      let seq = protInput.value.trim();
      if (!seq) {
        protResult.textContent = 'Please enter a protein sequence.';
        return;
      }
      // Remove any dashes
      seq = seq.replace(/-/g, '');
      seq = seq.toUpperCase();

      // Are we in "one-letter" or "three-letter" input mode?
      const inputMode = protInputFormat.value; // 'one' or 'three'

      // We'll parse accordingly:
      let aminoArr = [];

      if (inputMode === 'one') {
        // Each char is an amino acid code
        // Validate if only recognized single letters
        if (!/^[ARNDCEQGHILKMFPSTWYV]+$/.test(seq)) {
          protResult.textContent = 'Invalid 1-letter protein code detected.';
          return;
        }
        // Convert directly to array
        for (const aa of seq) {
          aminoArr.push(aa);
        }

      } else {
        // 'three' => parse in 3-letter blocks
        // Must be multiple of 3 in length
        if (seq.length % 3 !== 0) {
          protResult.textContent = 'Three-letter input must be in multiples of 3 letters (e.g., ALA, GLY).';
          return;
        }
        // Build a 3->1 map
        let threeToOne = {};
        for (const k in PROTEIN_TABLE) {
          const thr = PROTEIN_TABLE[k].three_letter.toUpperCase(); // e.g. "ALA"
          threeToOne[thr] = k; 
        }

        for (let i = 0; i < seq.length; i += 3) {
          const chunk = seq.substring(i, i+3); // e.g. "ALA"
          if (threeToOne[chunk]) {
            aminoArr.push(threeToOne[chunk]);
          } else {
            aminoArr.push('X'); // unknown
          }
        }
      }

      // 1) length
      const length = aminoArr.length;

      // 2) composition
      let compMap = {};
      for (const a of aminoArr) {
        compMap[a] = (compMap[a] || 0) + 1;
      }
      let compStr = Object.keys(compMap).sort().map(k => `${k}:${compMap[k]}`).join(', ');

      // 3) Reverse translation => naive RNA
      let letterToCodon = {};
      for (const codon in CODON_TABLE) {
        const one = CODON_TABLE[codon].one_letter;
        if (!letterToCodon[one]) {
          letterToCodon[one] = codon;
        }
      }
      let naiveRNA = '';
      for (const a of aminoArr) {
        if (letterToCodon[a]) {
          naiveRNA += letterToCodon[a];
        } else {
          naiveRNA += 'NNN';
        }
      }

      // 4) Always show both one-letter and three-letter output
      // a) One-letter
      const oneOutput = aminoArr.join('');
      // b) Three-letter
      let threeOutputArr = aminoArr.map(one => {
        if (PROTEIN_TABLE[one]) {
          return PROTEIN_TABLE[one].three_letter;
        } else {
          return 'Xxx';
        }
      });
      const threeOutput = threeOutputArr.join('-');

      // final result
      protResult.innerHTML = `
        <p><strong>Input Format:</strong> ${inputMode === 'one' ? 'One-letter' : 'Three-letter'}</p>
        <p><strong>Length:</strong> ${length}</p>
        <p><strong>Composition:</strong> ${compStr}</p>
        <p><strong>Naive Reverse Translation (to RNA):</strong> ${naiveRNA}</p>
        <p><strong>One-letter Output:</strong> ${oneOutput}</p>
        <p><strong>Three-letter Output:</strong> ${threeOutput}</p>
      `;
    });

    protClearBtn.addEventListener('click', () => {
      protInput.value = '';
      protResult.innerHTML = '';
    });
  </script>
</body>
</html>
